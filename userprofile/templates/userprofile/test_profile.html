{% extends "base.html" %}

{% block content %}
    <div class="container center grey lighten-3">
        <section class="profile-section">
            <div class="heading-row row row-margin-delete">
                <div class="heading-box col s12">
                    <h2 class="hm right">Hey {{ user.first_name }}!</h2>
                </div>
            </div>
            <div class="crumbs-row row">
                <nav class="crumbs-box col s10 m6 right transparent z-depth-0">
                    <div class="nav-wrapper right ">
                          <a  href="#!" class="breadcrumb black-text">Profile</a>
                          <a  href="#!" class="breadcrumb grey-text">Send</a>
                          <a  href="#!" class="breadcrumb grey-text">References</a>
                    </div>
                </nav>
            </div>
            <div class="req-reference-row row">
                <div class="col s12 profilesque-image grey darken-4">
                    <a class="btn" id="req-reference" href="{% url 'send_request' %}">Ask For Reference</a>
                </div>
            </div>
            <div class="counter-row row row-margin-delete">
                <div class="col s6 counter-box">
                    <div class="card right-align rounded">
                        <div class="card-content">
                            <span class="hs card-title"> Requests </span>
                            <span class="xl3">{{ count_requests }}</span>
                        </div>
                    </div>
                </div>

                <div class=" col s6 counter-box">
                    <div class="card right-align rounded">
                        <div class="card-content">
                            <span class="hs card-title"> References </span>
                            <span class="xl3">{{ count_responses }}</span>
                        </div>
                    </div>
                </div>
            </div>
        </section>
        <section class="grey rounded">
            <div class="row">
                <div class="col s12 card-panel rounded left-align">
                    <h3 class="hs">Requests awaiting response <i class="material-icons small right">access_time</i></h3>
                    <hr/>

                    <div class="collection ">
                        {% for request in requests %}
                            {% if request.status == "PEND" %}
                            <a class=" collection-item " href="">
                                <div class="row valign-wrapper">
                                    <div class="col s9 content truncate">
                                        <p class="truncate blue-text">
                                             Request to: {{ request.company_name }}<br />
                                             Email recipient: {{ request.to_email }}<br />
                                            date sent: {{ request.time_sent }} <br />
                                            status: {{ request.status }}  
                                        </p>
                                    </div>
                                    <div class="col s3">
                                        <i class="right material-icons blue-text">delete</i>
                                    </div>  
                                </div>
                            </a>
                            {% endif %}
                        {% endfor %}
                    </div>
            </div>
            </div>
            
            <div class="row">
                <div class="col s12 card-panel rounded left-align">
                    <h3 class="hs">My References <i class="material-icons small right">list</i></h3>
                    <hr/>
                    
                    
                    <div class="collection">
                        <div class="row collection-item reference-collection grey lighten-3">
                            <div class="col s3 truncate left-align bold">Name</div>
                                    <div class="col s6 truncate center-align bold">Response</div>
                                    <div class="col s3 truncate right-align bold">Response Date</div>
                        </div>
                        {% for response in comp_responses %}
                        <a class="row collection-item reference-collection blue-text" href="">
                                <div class="col s3 truncate left-align"> {{ response.get_full_name }}</div>
                                <div class="col s6 truncate center-align">{{ response.elaborate }}</div>
                                <div class="col s3 truncate right-align">{{ response.time_added }}</div>
                        </a>
                        {% empty %}
                        <div class="col s12 truncate center-align collection-item grey-text"> 
                            <p>You don't have any references yet. They will show up here.</p>
                        </div>
                       {% endfor %}
                    </div>
                        
                    </div>
                    
                </div>
            </div>
        </section>

{% endblock content %}